{% extends "base.html" %}

{% block title %}Comparador H2H - SoloQ Cerditos{% endblock %}

{% block head %}
    <link rel="stylesheet" href="{{ url_for('static', filename='h2h.css') }}">
{% endblock %}

{% block content %}
<div class="h2h-container">
    <h1 class="text-center">Comparador Head-to-Head</h1>
    <form class="player-selector" method="GET" action="{{ url_for('h2h') }}">
        <select name="player1" id="player1" class="form-select">
            <option value="">Selecciona Jugador 1</option>
            {% for player in players %}
            <option value="{{ player.puuid }}" {% if request.args.get('player1') == player.puuid %}selected{% endif %}>{{ player.jugador }}</option>
            {% endfor %}
        </select>
        <select name="player2" id="player2" class="form-select">
            <option value="">Selecciona Jugador 2</option>
            {% for player in players %}
            <option value="{{ player.puuid }}" {% if request.args.get('player2') == player.puuid %}selected{% endif %}>{{ player.jugador }}</option>
            {% endfor %}
        </select>
        <select name="queue_type" id="queue_type" class="form-select">
            <option value="RANKED_SOLO_5x5" {% if selected_queue == 'RANKED_SOLO_5x5' %}selected{% endif %}>SoloQ</option>
            <option value="RANKED_FLEX_SR" {% if selected_queue == 'RANKED_FLEX_SR' %}selected{% endif %}>Flex</option>
        </select>
        <button type="submit" class="btn btn-primary">Comparar</button>
    </form>

    {% if comparison_data %}
    <div class="comparison-grid">
        <!-- Header -->
        <div class="player-card card">
            <div class="card-body">
                <h2 class="card-title">{{ comparison_data.player1.jugador }}</h2>
                <p class="text-muted">{{ comparison_data.player1.game_name }}</p>
            </div>
        </div>
        <div></div> <!-- Spacer column -->
        <div class="player-card card">
            <div class="card-body">
                <h2 class="card-title">{{ comparison_data.player2.jugador }}</h2>
                <p class="text-muted">{{ comparison_data.player2.game_name }}</p>
            </div>
        </div>

        <!-- Stats -->
        <div class="stat-value">{{ comparison_data.player1.stats.tier }} {{ comparison_data.player1.stats.rank }}</div>
        <div class="stat-label">Rank</div>
        <div class="stat-value">{{ comparison_data.player2.stats.tier }} {{ comparison_data.player2.stats.rank }}</div>
        
        <div class="stat-value">{{ comparison_data.player1.stats.league_points }} LP</div>
        <div class="stat-label">LP</div>
        <div class="stat-value">{{ comparison_data.player2.stats.league_points }} LP</div>

        <div class="stat-value">{{ "%.2f"|format(comparison_data.player1.kda) }}</div>
        <div class="stat-label">KDA</div>
        <div class="stat-value">{{ "%.2f"|format(comparison_data.player2.kda) }}</div>

        <div class="stat-value">{{ "%.1f"|format(comparison_data.player1.winrate) }}%</div>
        <div class="stat-label">Winrate</div>
        <div class="stat-value">{{ "%.1f"|format(comparison_data.player2.winrate) }}%</div>
        
        <!-- H2H Record -->
        <div class="stat-value" style="font-size: 2em; color: {% if comparison_data.h2h.player1_wins > comparison_data.h2h.player2_wins %}#28a745 !important{% elif comparison_data.h2h.player1_wins < comparison_data.h2h.player2_wins %}#dc3545 !important{% else %}#6c757d !important{% endif %};">
            {{ comparison_data.h2h.player1_wins }}
        </div>
        <div class="stat-label" style="font-size: 1.5em;">H2H Wins</div>
        <div class="stat-value" style="font-size: 2em; color: {% if comparison_data.h2h.player2_wins > comparison_data.h2h.player1_wins %}#28a745 !important{% elif comparison_data.h2h.player2_wins < comparison_data.h2h.player1_wins %}#dc3545 !important{% else %}#6c757d !important{% endif %};">
            {{ comparison_data.h2h.player2_wins }}
        </div>
    </div>
    {% elif request.args.get('player1') and request.args.get('player2') %}
        <div class="text-center mt-4 alert alert-warning">
            <p>No se pudieron cargar los datos para la comparación o no hay partidas en común en la cola seleccionada.</p>
        </div>
    {% endif %}
</div>
{% endblock %}
